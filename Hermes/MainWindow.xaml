<Window x:Class="Hermes.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:viewmodels="clr-namespace:Hermes.ViewModels"
        Title="Sistema HERMES - Panel Broker" 
        Height="700" Width="1200"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized">
    
    <Window.DataContext>
        <viewmodels:MainViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="60"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#2C3E50" Padding="20,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="🏢 HERMES" 
                               FontSize="24" 
                               FontWeight="Bold"
                               Foreground="White"
                               Margin="0,0,30,0"/>
                    <TextBlock Text="Panel de Administracion" 
                               FontSize="16" 
                               Foreground="#BDC3C7"
                               VerticalAlignment="Center"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="{Binding NombreUsuarioActual}"
                               FontSize="14"
                               Foreground="White"
                               VerticalAlignment="Center"
                               Margin="0,0,10,0"/>
                    <TextBlock FontSize="12"
                               Foreground="#3498DB"
                               VerticalAlignment="Center"
                               Margin="0,0,20,0">
                        <Run Text="("/><Run Text="{Binding RolUsuario, Mode=OneWay}"/><Run Text=")"/>
                    </TextBlock>
                    <Button Content="Cerrar Sesion"
                            Command="{Binding CerrarSesionCommand}"
                            Style="{StaticResource DangerButtonStyle}"
                            Padding="15,8"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Content Area -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- Sidebar Menu -->
            <Border Grid.Column="0" Background="#34495E" Padding="0,20">
                <StackPanel>
                    <!-- Opciones de administración (solo Broker) -->
                    <Button Content="📊 Dashboard"
                            Command="{Binding MostrarDashboardCommand}"
                            Style="{StaticResource MenuButtonStyle}"
                            Margin="10,5"
                            Visibility="{Binding EsAdministrador, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <Button Content="👥 Gestion de Empleados"
                            Command="{Binding MostrarGestionEmpleadosCommand}"
                            Style="{StaticResource MenuButtonStyle}"
                            Margin="10,5"
                            Visibility="{Binding EsAdministrador, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <Button Content="✓ Gestion de Tareas"
                            Command="{Binding MostrarGestionTareasCommand}"
                            Style="{StaticResource MenuButtonStyle}"
                            Margin="10,5"
                            Visibility="{Binding EsAdministrador, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                    <!-- Separador para sección de Bandejas (visible solo si hay opciones arriba O si puede enviar tareas) -->
                    <Separator Margin="10,15" Background="#7F8C8D" Height="1"
                               Visibility="{Binding EsAdministrador, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                    <TextBlock Text="BANDEJAS DE TAREAS"
                               Foreground="#95A5A6"
                               FontSize="11"
                               FontWeight="Bold"
                               Margin="15,5,15,10"/>

                    <!-- Tareas Enviadas - solo para Broker, Secretaria y Abogada/Abogado -->
                    <Button Content="📤 Tareas Enviadas"
                            Command="{Binding MostrarBandejaTareasEnviadasCommand}"
                            Style="{StaticResource MenuButtonStyle}"
                            Margin="10,5"
                            Visibility="{Binding PuedeEnviarTareas, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                    <!-- Tareas Recibidas - para TODOS los roles -->
                    <Button Content="📥 Tareas Recibidas"
                            Command="{Binding MostrarBandejaTareasRecibidasCommand}"
                            Style="{StaticResource MenuButtonStyle}"
                            Margin="10,5"/>

                    <!-- Separador (solo visible para administradores) -->
                    <Separator Margin="10,15" Background="#7F8C8D" Height="1"
                               Visibility="{Binding EsAdministrador, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                    <!-- Opciones adicionales (solo Broker) -->
                    <Button Content="📋 Propiedades"
                            Style="{StaticResource MenuButtonStyle}"
                            Margin="10,5"
                            Visibility="{Binding EsAdministrador, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <Button Content="🏠 Clientes"
                            Style="{StaticResource MenuButtonStyle}"
                            Margin="10,5"
                            Visibility="{Binding EsAdministrador, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <Button Content="💼 Transacciones"
                            Style="{StaticResource MenuButtonStyle}"
                            Margin="10,5"
                            Visibility="{Binding EsAdministrador, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <Button Content="📊 Reportes"
                            Style="{StaticResource MenuButtonStyle}"
                            Margin="10,5"
                            Visibility="{Binding EsAdministrador, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                </StackPanel>
            </Border>
            
            <!-- Main Content Area -->
            <ContentControl Grid.Column="1" 
                          Content="{Binding CurrentView}"
                          Margin="20"/>
        </Grid>
    </Grid>
</Window>
